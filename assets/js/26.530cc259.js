(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{381:function(s,t,a){"use strict";a.r(t);var e=a(42),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"travis-ci-简介及使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#travis-ci-简介及使用"}},[s._v("#")]),s._v(" Travis CI 简介及使用")]),s._v(" "),a("p",[s._v("Travis CI 提供的是持续集成服务（Continuous Integration）。绑定 Github 上的项目，自动抓取新的代码，执行测试，完成构建，部署到服务器。"),a("br"),s._v("\n持续集成指的是只要有代码变更，就自动运行构建和测试，反馈运行结果。确保符合预期后，再将新代码“集成”到主干。")]),s._v(" "),a("h2",{attrs:{id:"travis-ci-的使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#travis-ci-的使用"}},[s._v("#")]),s._v(" Travis CI 的使用")]),s._v(" "),a("p",[s._v("Travis CI 只支持 github，所以需要在 github 上有项目，并且项目里包含构建或测试脚本，以及可运行的代码。"),a("br"),s._v("\n准备步骤（傻瓜式教程）：")]),s._v(" "),a("ol",[a("li",[s._v("在 github 上的用户设置（点击头像出现的 Settings），点击“Developer settings”，点击“Personal access tokens”；")]),s._v(" "),a("li",[s._v("点击“Generate new token”，在“Note”输入框中输入备注名，勾选“repo”，生成一个新的 token 并复制；")]),s._v(" "),a("li",[s._v("用该账号登录"),a("a",{attrs:{href:"https://travis-ci.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方网站"),a("OutboundLink")],1),s._v("；")]),s._v(" "),a("li",[s._v("进入用户设置（点击头像出现的 Settings），选择一个仓库并点击 Settings，找到“Environment Variables”下的输入框，输入复制的 token；")]),s._v(" "),a("li",[s._v("为选择的仓库添加 .travis.yml。（.travis.yml 是 Travis 的配置文件，代码仓库有新的 Commit 时，Travis 就会执行该文件里面的命令。）")])]),s._v(" "),a("h2",{attrs:{id:"travis-ci-生命周期-运行流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#travis-ci-生命周期-运行流程"}},[s._v("#")]),s._v(" Travis CI 生命周期/运行流程")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://docs.travis-ci.com/user/job-lifecycle/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),a("OutboundLink")],1),s._v("。")]),s._v(" "),a("h3",{attrs:{id:"完整的工作流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#完整的工作流程"}},[s._v("#")]),s._v(" 完整的工作流程")]),s._v(" "),a("ol",[a("li",[s._v("OPTIONAL Install "),a("code",[s._v("apt addons")])]),s._v(" "),a("li",[s._v("OPTIONAL Install "),a("code",[s._v("cache components")])]),s._v(" "),a("li",[a("code",[s._v("before_install")])]),s._v(" "),a("li",[a("code",[s._v("install")])]),s._v(" "),a("li",[a("code",[s._v("before_script")])]),s._v(" "),a("li",[a("code",[s._v("script")])]),s._v(" "),a("li",[s._v("OPTIONAL "),a("code",[s._v("before_cache")]),s._v(" (for cleaning up cache)")]),s._v(" "),a("li",[a("code",[s._v("after_success")]),s._v(" or "),a("code",[s._v("after_failure")])]),s._v(" "),a("li",[s._v("OPTIONAL "),a("code",[s._v("before_deploy")])]),s._v(" "),a("li",[s._v("OPTIONAL "),a("code",[s._v("deploy")])]),s._v(" "),a("li",[s._v("OPTIONAL "),a("code",[s._v("after_deploy")])]),s._v(" "),a("li",[a("code",[s._v("after_script")])])]),s._v(" "),a("h3",{attrs:{id:"示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[s._v("#")]),s._v(" 示例")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("language")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" node_js\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("node_js")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" v12.10.0\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("install")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" yarn install\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" yarn build\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("deploy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下面是 Travis CI 部署到 GitHub Pages 的配置 https://docs.travis-ci.com/user/deployment/pages/")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("provider")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pages\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("skip_cleanup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 防止 Travis CI 重置工作目录")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("local_dir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" dist    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当前目录的路径")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("github_token")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("travis_token"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在 GitHub 中生成，用于允许 Travis 向仓库推送代码")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("repo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 推送的目的仓库名")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("target_branch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 目标分支，默认 gh-pages")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("keep_history")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保持 commit 记录")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("fqdn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置自定义域名，默认不支持")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("project_name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认 fqdn 的值或者 repo slug")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("email")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 提交者的信息，默认 deploy@travis-ci.org")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 提交者，默认 Deployment Bot")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("committer_from_gh")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 用 token 所有者的信息提交，会覆盖 name 和 email 选项，默认 false")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("allow_empty_commit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在 keep_history: true 时启用，默认 false")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("github_url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("verbose")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 内部步骤的详细，默认 false")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("deployment_file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启用创建依赖信息文件，默认 false")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("branch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" master\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br")])]),a("ul",[a("li",[s._v("language：指定默认环境，"),a("a",{attrs:{href:"https://docs.travis-ci.com/user/languages",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),a("OutboundLink")],1)]),s._v(" "),a("li",[s._v("install：必经阶段一，安装依赖阶段。"),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("install")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" skip "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 跳过安装脚本")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("install")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ./project"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("dependencies.sh "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 项目的依赖脚本，需要加可操作权限")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("install")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 多个步骤的脚本命令")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" step1\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" step2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])])]),s._v(" "),a("li",[s._v("script：必经阶段二，构建阶段。"),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不执行任何脚本")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[s._v("deploy：可选阶段——部署。这个阶段，会使用持续部署提供商部署代码到不同平台。")])])])}),[],!1,null,null,null);t.default=n.exports}}]);